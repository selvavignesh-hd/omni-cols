# Reference this view as companies
label: Companies

schema: public
sql: |-
  SELECT "company_master"."org_id" AS "company_master.org_id",
      "company_master"."name" AS "company_master.name",
      "company_master"."primary_city" AS "company_master.primary_city",
      "company_master"."primary_state" AS "company_master.primary_state",
      "company_master"."status" AS "company_master.status",
      "organizations"."code" AS "organizations.code"
  FROM "company_master"
      LEFT JOIN "organizations" ON "company_master"."org_id" = "organizations"."id"
  GROUP BY 2, 1, 3, 4, 5, 6
  ORDER BY 1 NULLS FIRST
  LIMIT 1000

dimensions:
  company_master_org_id:
    sql: '"company_master.org_id"'

  company_master_name:
    sql: '"company_master.name"'

  company_master_primary_city:
    sql: '"company_master.primary_city"'

  company_master_primary_state:
    sql: '"company_master.primary_state"'

  company_master_status:
    sql: '"company_master.status"'

  organizations_code:
    sql: '"organizations.code"'

measures:
  count:
    aggregate_type: count
